<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>LFA Overlay</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #1a1a1a;
      font-family: Arial, sans-serif;
      color: white;
      overflow: hidden;
    }

    #live-banner {
      position: absolute;
      top: 10px;
      left: 10px;
      background-color: rgba(0, 0, 0, 0.8); /* Set background to black */
      padding: 6px 12px;
      border-radius: 5px;
      font-size: 1rem;
      font-weight: bold;
      letter-spacing: 1px;
    }

    #live-banner span {
      color: red;
    }

    .weather-bar {
      position: absolute;
      bottom: 0;
      width: 100%;
      background-color: rgba(0, 0, 0, 0.6);
      padding: 6px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.9rem;
      box-sizing: border-box;
    }

    .data-group {
      display: flex;
      align-items: center;
      gap: 25px;
      flex: 1;
    }

    .weather-section {
      display: flex;
      align-items: center;
      gap: 4px;
      height: 24px;
    }

    .direction-arrow {
      width: 0;
      height: 0;
      border-left: 5px solid transparent;
      border-right: 5px solid transparent;
      border-bottom: 12px solid red;
      margin-left: 3px;
      margin-top: 2px;
      transition: transform 0.3s ease;
    }

    .weather-icon {
      width: 24px;
      height: 24px;
    }

    .time-display {
      font-size: 1rem;
      font-weight: bold;
      white-space: nowrap;
      padding-left: 10px;
    }

    .scrolling-column {
      flex: 2;
      overflow: hidden;
      height: 24px;
      position: relative;
    }

    .scrolling-banner {
      white-space: nowrap;
      color: white;
      font-size: 0.9rem;
      font-weight: bold;
      animation: scroll-banner 120s linear infinite;
      position: absolute;
      will-change: transform;
      line-height: 25px; /* Matches the container height */
    }

    @keyframes scroll-banner {
      0% {
        transform: translateX(50%);
      }
      100% {
        transform: translateX(-100%);
      }
    }
  </style>
</head>
<body>
  <div id="live-banner"><span>LIVE</span> EAST MIDLANDS AIRPORT</div>
  
  <div class="weather-bar">
    <div class="data-group">
      <div class="weather-section" id="temp-section">TEMP: <span id="temp"></span></div>
      <div class="weather-section" id="feels-section">FEELS: <span id="feels-like"></span></div>
      <div class="weather-section" id="weather-section">WEATHER: <img id="weather-icon" class="weather-icon" src="" alt="Icon"></div>
      <div class="weather-section" id="wind-section">WIND: <span id="wind-speed"></span> <span id="wind-dir"></span><div class="direction-arrow" id="direction-arrow"></div></div>
      <div class="weather-section" id="vis-section">VISIBILITY: <span id="visibility"></span></div>

      <!-- NEW scrolling banner column -->
      <div class="scrolling-column">
        <div class="scrolling-banner">
          WELCOME TO LIVE FLIGHT ACTION! THANK YOU FOR TUNING IN TO TODAY’S STREAM — YOU’RE PART OF AN EPIC AVIATION JOURNEY!
SUBSCRIBE NOW TO JOIN OUR GROWING CREW OF AVIATION ENTHUSIASTS!
LIKE, SHARE & HIT THAT BELL TO STAY UP TO DATE WITH ALL OUR LIVE FLIGHT ACTION.
WANT TO SUPPORT THE CHANNEL? CHECK OUT OUR MEMBERSHIPS & BUY ME A COFFEE ☕️ — LINKS ON OUR CHANNEL PAGE.
AND DON’T FORGET TO FOLLOW @LIVEFLIGHTACTION ON TIKTOK, INSTAGRAM & FACEBOOK FOR MORE LIVE FLIGHT ACTION CONTENT! 
        </div>
      </div>
    </div>

    <div class="time-display" id="time-display"></div>
  </div>

  <script>
    async function fetchWeatherData() {
      const apiKey = '58301b9e3cb6cdfab0c2a0e6765e67d4';
      const lat = 52.8317;
      const lon = -1.3316;
      const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric`;

      try {
        const response = await fetch(url);
        const data = await response.json();

        if (data.cod === 200) {
          const temp = `${data.main.temp.toFixed(1)}°C`;
          const feelsLike = `${data.main.feels_like.toFixed(1)}°C`;
          const iconCode = data.weather[0].icon;
          const iconUrl = `https://openweathermap.org/img/wn/${iconCode}.png`;
          const windSpeed = `${(data.wind.speed * 1.94384).toFixed(1)} kts`;
          const windDeg = data.wind.deg;
          const visibilityMiles = (data.visibility / 1609.34).toFixed(1);

          document.getElementById('temp').innerText = temp;
          document.getElementById('feels-like').innerText = feelsLike;
          document.getElementById('weather-icon').src = iconUrl;
          document.getElementById('wind-speed').innerText = windSpeed;
          document.getElementById('visibility').innerText = `${visibilityMiles} mi`;

          // Arrow rotation
          const adjustedDirection = (windDeg + 180) % 360;
          document.getElementById('direction-arrow').style.transform = `rotate(${adjustedDirection}deg)`;

          // Convert to compass direction
          const compassDirections = ['N','NE','E','SE','S','SW','W','NW'];
          const index = Math.round(windDeg / 45) % 8;
          document.getElementById('wind-dir').innerText = compassDirections[index];
        } else {
          showError();
        }
      } catch {
        showError();
      }
    }

    function showError() {
      const fields = ['temp','feels-like','weather-icon','wind-speed','wind-dir','visibility'];
      fields.forEach(id => {
        const el = document.getElementById(id);
        if (el) el.innerText = 'N/A';
      });
    }

    function updateTime() {
      const now = new Date();
      const hours = now.getHours().toString().padStart(2, '0');
      const mins = now.getMinutes().toString().padStart(2, '0');
      document.getElementById('time-display').innerText = `${hours}:${mins}`;
    }

    fetchWeatherData();
    setInterval(fetchWeatherData, 1800000); // 30 mins
    updateTime();
    setInterval(updateTime, 1000); // Update every second
  </script>
</body>
</html>
